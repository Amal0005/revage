<%- include("../../views/partials/admin/header.ejs") %>

<style>
    /* Base Styles */
    body {
        font-family: 'Inter', sans-serif;
        background-color: #f8f9fa;
        color: #333;
        line-height: 1.6;
    }

    .dashboard-container {
        padding: 2rem;
    }

    /* Header Section */
    .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
    }

    .header-title h1 {
        font-size: 1.8rem;
        font-weight: 600;
        color: #1a1a1a;
        margin: 0;
    }

    .header-title p {
        color: #6c757d;
        margin: 0.5rem 0 0 0;
    }

    /* Stats Cards */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .stat-card {
        background: #fff;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.04);
        transition: transform 0.2s ease;
    }

    .stat-card:hover {
        transform: translateY(-5px);
    }

    .stat-header {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
    }

    .stat-icon {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
    }

    .stat-icon.revenue { background-color: #e3f2fd; }
    .stat-icon.orders { background-color: #e8f5e9; }
    .stat-icon.products { background-color: #fff3e0; }
    .stat-icon.earnings { background-color: #f3e5f5; }

    .stat-icon i {
        font-size: 1.5rem;
    }

    .stat-icon.revenue i { color: #1976d2; }
    .stat-icon.orders i { color: #2e7d32; }
    .stat-icon.products i { color: #f57c00; }
    .stat-icon.earnings i { color: #7b1fa2; }

    .stat-info h3 {
        font-size: 1.5rem;
        font-weight: 600;
        margin: 0;
    }

    .stat-info p {
        color: #6c757d;
        font-size: 0.875rem;
        margin: 0.25rem 0 0 0;
    }

    /* Charts Section */
    .charts-section {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .chart-card {
        background: #fff;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.04);
    }

    .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
    }

    .chart-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #1a1a1a;
        margin: 0;
    }

    /* Recent Orders Table */
    .orders-section {
        background: #fff;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.04);
    }

    .orders-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
    }

    .orders-table th {
        background: #f8f9fa;
        padding: 1rem;
        font-weight: 600;
        text-align: left;
        color: #1a1a1a;
    }

    .orders-table td {
        padding: 1rem;
        border-top: 1px solid #e9ecef;
    }

    .orders-table tr:hover {
        background-color: #f8f9fa;
    }

    .status-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.875rem;
        font-weight: 500;
    }

    .status-completed { background: #e8f5e9; color: #2e7d32; }
    .status-pending { background: #fff3e0; color: #f57c00; }
    .status-cancelled { background: #ffebee; color: #c62828; }

    /* Responsive Design */
    @media (max-width: 1200px) {
        .charts-section {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 768px) {
        .dashboard-container {
            padding: 1rem;
        }

        .stats-grid {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        }

        .dashboard-header {
            flex-direction: column;
            align-items: flex-start;
        }
    }
</style>

<div class="dashboard-container">
    <!-- Header Section -->
    <div class="dashboard-header">
        <div class="header-title">
            <h1>Dashboard Overview</h1>
            <p>Welcome back! Here's what's happening with your store today.</p>
        </div>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-header">
                <div class="stat-icon revenue">
                    <i class="fas fa-dollar-sign"></i>
                </div>
                <div class="stat-info">
                    <h3>₹<%= totalRevenue || '0' %></h3>
                    <p>Total Revenue</p>
                </div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-header">
                <div class="stat-icon orders">
                    <i class="fas fa-shopping-bag"></i>
                </div>
                <div class="stat-info">
                    <h3><%= totalOrders || '0' %></h3>
                    <p>Total Orders</p>
                </div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-header">
                <div class="stat-icon products">
                    <i class="fas fa-box"></i>
                </div>
                <div class="stat-info">
                    <h3><%= totalProducts || '0' %></h3>
                    <p>Total Products</p>
                </div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-header">
                <div class="stat-icon earnings">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="stat-info">
                    <h3>₹<%= monthlyEarnings || '0' %></h3>
                    <p>Monthly Earnings</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-section">
        <div class="chart-card">
            <div class="chart-header">
                <h2 class="chart-title">Sales Analytics</h2>
            </div>
            <canvas id="salesChart" height="300"></canvas>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h2 class="chart-title">Top Categories</h2>
            </div>
            <canvas id="categoryChart" height="300"></canvas>
        </div>
    </div>

    <!-- Recent Orders Section -->
    <div class="orders-section">
        <div class="chart-header">
            <h2 class="chart-title">Recent Orders</h2>
        </div>
        <div class="table-responsive">
            <table class="orders-table">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>Customer</th>
                        <th>Product</th>
                        <th>Amount</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (recentOrders && recentOrders.length > 0) { %>
                        <% recentOrders.forEach(order => { %>
                            <tr>
                                <td>#<%= order._id.toString().slice(-6).toUpperCase() %></td>
                                <td><%= order.user.name %></td>
                                <td><%= order.items[0].product.productName %></td>
                                <td>₹<%= order.totalAmount %></td>
                                <td>
                                    <span class="status-badge status-<%= order.status.toLowerCase() %>">
                                        <%= order.status %>
                                    </span>
                                </td>
                            </tr>
                        <% }); %>
                    <% } else { %>
                        <tr>
                            <td colspan="5" style="text-align: center;">No recent orders found</td>
                        </tr>
                    <% } %>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Sales Analytics Chart
    const salesCtx = document.getElementById('salesChart').getContext('2d');
    new Chart(salesCtx, {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
                label: 'Sales',
                data: [30, 45, 35, 50, 40, 60],
                borderColor: '#1976d2',
                tension: 0.4,
                fill: false
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    grid: {
                        display: true,
                        color: '#e9ecef'
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });

    // Category Chart
    const categoryCtx = document.getElementById('categoryChart').getContext('2d');
    new Chart(categoryCtx, {
        type: 'doughnut',
        data: {
            labels: ['Electronics', 'Clothing', 'Books', 'Others'],
            datasets: [{
                data: [30, 25, 20, 25],
                backgroundColor: ['#1976d2', '#2e7d32', '#f57c00', '#7b1fa2']
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            }
        }
    });
</script>

<%- include("../../views/partials/admin/footer.ejs") %>
